---
layout:     "post"
title:      "Bugreport 101"
subtitle:   "Um ensaio sobre bugs e relat√≥rios"
date:       2017-03-10 12:00:00
author:     "Fl√°vio Caetano"
header-img: "img/fjcaetano/computer-data-analytics-blue-background-website-header.jpg"
category:   "comunidade"
---

> Fl√°vio Caetano ([@flavio_caetano](https://twitter.com/flavio_caetano){:target="_blank"}) desenvolve para iOS desde 2011, quando a ger√™ncia de mem√≥ria era manual e storyboard era coisa de cinema. J√° trabalhou em alguns dos maiores (e menores) apps do Brasil e atualmente lidera o desenvolvimento em iOS no [Winnin](https://winnin.com/){:target="_blank"}.
>
> Este post √© um complemento ao talk [Bugreport 101](https://www.slideshare.net/FlavioVieiraCaetano/bugreport-101-72988003){:target="_blank"} apresentado no 28¬∫ CocoaHeads SP

√â muito f√°cil encontrar desenvolvedores que j√° acharam algum tipo de bug em c√≥digo de terceiros. Seja numa lib externa, seja no SDK da Apple. Nosso c√≥digo, lindo e cheiroso, com um comportamento indesejado por causa de uma pessoa que n√£o est√° nem na mesma folha de pagamentos que voc√™. Tamb√©m n√£o √© dif√≠cil encontrar devs que j√° reportaram tais bugs para os respons√°veis pelo c√≥digo ou que contribu√≠ram para a sua corre√ß√£o de alguma forma. Mas, n√£o t√£o f√°cil √© encontrar desenvolvedores que reportaram algum tipo de bug para a Apple.

A falta de material sobre _bugreport_, seja motivacional, sejam guidelines, acentuam esse fato. Frequentes s√£o os reports sem informa√ß√£o relevante, com dados confidenciais ou c√≥pias id√™nticas de reports j√° preenchidos sem adi√ß√£o de nenhum dado novo.

Na esfera do desenvolvimento para plataformas Apple, n√£o importa o qu√£o individualista voc√™ seja. Mesmo que n√£o use nenhuma biblioteca de terceiros, todos estamos sob o guarda-chuva do SDK da Apple. N√£o importa o qu√£o blindado o seu c√≥digo seja de desenvolvedores externos, todos estamos sujeitos aos erros e acertos dos desenvolvedores da Apple.

![Computer gone](https://mlkshk-ada.kxcdn.com/r/ZE20)

## Ilumine o problema

O motivo principal para reportar um bug n√£o √© √≥bvio. Ferramentas de _issue tracking_ foram criadas para relatar incidentes, isto √©, chamar aten√ß√£o para um comportamento inesperado.

![Algo de errado n√£o est√° certo]({{ site.baseurl }}/img/fjcaetano/10_guy.jpg)

Secundariamente, a corre√ß√£o do bug motiva o report. Se houver um _workaround_, ou alguma forma de contornar o problema, a corre√ß√£o do bug pode n√£o ser priorit√°ria.

Ademais, n√£o podemos nunca esquecer de quem cria essas bibliotecas. Relatar uma _issue_ demonstra apoio ao c√≥digo que usamos e √†s pessoas que o constroem, por isso, n√£o pe√ßa desculpas ao reportar um bug. Agrade√ßa pela cria√ß√£o da biblioteca.

## Bugreport √© dinheiro

Grandes empresas precisam tanto de ajuda que tornaram programas de Bug Bounty lugar-comum. A demanda por relat√≥rios de _exploits_ e vulnerabilidades √© t√£o grande que Facebook, Github, Google, Microsoft e diversas outras empresas reconhecem e recompensam aqueles que descobrem e resolvem bugs antes destas inconsist√™ncias se tornarem p√∫blicas.

Em 2016 o Departamento de Defesa americano anunciou um programa chamado [Hack the Pentagon](https://www.defense.gov/News/Article/Article/684616/dod-invites-vetted-specialists-to-hack-the-pentagon) no qual especialistas em seguran√ßas foram convidados a tentar invadir p√°ginas p√∫blicas do Pent√°gono em busca de falhas de seguran√ßa. [Mais de US$71.000 foram pagos](https://en.wikipedia.org/wiki/Bug_bounty_program) em recompensas.

Tamb√©m em 2016, a [Apple anunciou](https://techcrunch.com/2016/08/04/apple-announces-long-awaited-bug-bounty-program/) a cria√ß√£o do seu programa de Bug Bounty. Relatos dizem de recompensas de at√© US$200.000 por√©m a participa√ß√£o no programa s√≥ √© poss√≠vel atrav√©s de convites.

<iframe src="//giphy.com/embed/QVgU7wEY0RlV6" width="480" height="271" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>

## Os 4 passos para um bom report

Diversas plataformas oferecem templates de relat√≥rios, o Github inclusive disponibiliza o arquivo [CONTRIBUTING guidelines](https://github.com/blog/1184-contributing-guidelines) para que cada reposit√≥rio documente como relatar e contribuir com o desenvolvimento dos c√≥digos. No entanto, com tantas possibilidades e sem um padr√£o, nem sempre √© f√°cil focar e ser conciso na reda√ß√£o do relat√≥rio.

![I have no idea what I'm doing]({{ site.baseurl }}/img/fjcaetano/p_lab.png)


#### 1. Tenha clareza sobre a inconsist√™ncia

Na introdu√ß√£o do relat√≥rio, seja claro sobre o comportamento obtido. O que era esperado? O que realmente est√° acontecendo?

#### 2. Defina os passos para reproduzir o bug

Inclua os passos para reproduzir e informe se o comportamento for intermitente. N√£o tem problema se n√£o der para reproduzir o bug todas as vezes, mas tenha certeza de que os passos descritos podem levar √† alguma inconsist√™ncia.

#### 3. Inclua exemplos de c√≥digo

Se for um relat√≥rio para a Apple, sempre anexe um projeto ou playground contendo a reprodu√ß√£o da inconsist√™ncia no seu radar. No caso de uma _issue_ no Github, pode-se incluir _snippets_ com c√≥digos de exemplos ou at√© links para reposit√≥rios contendo um projeto ou playground de exemplo.

#### 4. Sugira uma corre√ß√£o ou _workaround_

Se voc√™ souber a causa do bug ou onde ele ocorre, sugest√µes de corre√ß√£o s√£o mais que bem-vindas. Ou melhor que isso, corrija a inconsist√™ncia e j√° abra um _pull-request_ com o fix da inconsist√™ncia.

## Bugreports no Github

Acredito que o Github pe√ßa alguns cuidados especiais no relat√≥rio de incidentes, afinal, em reposit√≥rios open-source, as pessoas contribuem por boa vontade e, embora sejam os respons√°veis pelo c√≥digo, n√£o √© trabalho de ningu√©m ficar corrigindo os erros e inconsist√™ncias que est√£o te afetando.

√â importante n√£o ter medo de falar bobagem. A comunidade de iOS, especialmente, √© super receptiva e tolerante. Ningu√©m vai ficar apontando dedos ou fazendo gra√ßa, e se voc√™ disser alguma besteira, no m√°ximo ser√° corrigido com educa√ß√£o.

![Nelson: HAHA]({{ site.baseurl }}/img/fjcaetano/nelson_haha.jpg)

A l√≠ngua-comum da internet √© a L√≠ngua Inglesa, mas nem todos s√£o fluentes e menos ainda a t√™m como l√≠ngua nativa. N√£o tenha vergonha e nem medo do seu ingl√™s. √â comum encontrar pessoas de diversas partes do mundo cometendo erros gramaticais e ningu√©m √© corrigido, ignorado ou menosprezado porque n√£o falou ingl√™s perfeito. Cometemos erros at√© na hora de escrever em portugu√™s (este artigo mesmo deve conter alguns), o que dir√° em um idioma que n√£o √© o nosso. Lembre-se que a pr√°tica leva √† perfei√ß√£o.

Al√©m disso, tenha em mente que os projetos e bibliotecas do Github s√£o comunit√°rios, consequentemente, como em toda democracia propriamente dita √© comum que corre√ß√µes e _proposals_ de incrementos sejam longamente debatidos antes de se chegar num acordo sobre a melhor forma de proceder. Portanto, seja coerente, tenha paci√™ncia e saiba argumentar escutando o lado oposto. Esta pode ser uma oportunidade fant√°stica para voc√™ aprofundar o seu conhecimento sobre aquela ferramenta, al√©m de receber coment√°rios sobre o seu c√≥digo de desenvolvedores fant√°sticos que criam as bibliotecas mais usadas do mundo. Escute e aprenda!

Ainda sobre o assunto, recomendo o excelente artigo [O mundo √© mais que seu umbigo]({{ site.baseurl }}/open-source/2016/02/29/o-mundo-e-mais-que-seu-umbigo/) do Fabri que inaugurou o equinociOS

## Bugreports para a Apple

A Apple possui o [seu portal](http://bugreport.apple.com/) onde podem ser relatados _issues_ e _feature requests_. Numa interface de gosto duvidoso (nem parece coisa de Jony Ive)

[![Apple Bugreport Portal]({{ site.baseurl }}/img/fjcaetano/apple_bugreport.png)]({{ site.baseurl }}/img/fjcaetano/apple_bugreport.png)

Para aqueles que n√£o gostam do portal, h√° tamb√©m o [QuickRadar](http://www.quickradar.com/) que prov√™ uma interface muito mais limpa e n√£o pede que voc√™ se logue toda vez que quiser reportar uma _issue_, al√©m de te oferecer um template simples num campo de texto √∫nico para preenchimento.

[![QuickRadar]({{ site.baseurl }}/img/fjcaetano/quickradar.png)]({{ site.baseurl }}/img/fjcaetano/quickradar.png)

Os bugs reportados para a Apple s√£o privados por quest√£o de seguran√ßa. Embora o grosso dos bugs seja comportamental, existem vulnerabilidades e falhas de seguran√ßa que podem ser exploradas para obter vantagem sobre os usu√°rios e que n√£o podem se tornar p√∫blicas para evitar exposi√ß√£o. Por isso, surgiu o [OpenRadar](https://openradar.appspot.com) que tenta ser um espelho do portal da Apple, onde os desenvolvedores replicam seus relat√≥rios para torn√°-los p√∫blicos. Uma das vantagens do QuickRadar √© mandar as suas issues automaticamente para o OpenRadar, mitigando a necessidade de preencher tudo duas vezes.

O OpenRadar ainda oferece a possiblidade de comentar nas p√°ginas das _issues_ o que acrescenta uma din√¢mica mais rica na intera√ß√£o com a comunidade. Em 2016 reportei um bug na `UICollectionView` que os engenheiros da Apple descartaram como sendo o comportamento correto. Discordei da decis√£o mas <del>como bug documentado √© feature</del> pedi para que tal comportamento fosse adicionado na documenta√ß√£o, pedido que foi ignorado, e no [rdar://28323532](https://openradar.appspot.com/radar?id=5022915414196224) podemos ver que o usu√°rio **nicolas.millasseau** tamb√©m discordou da decis√£o dos engenheiros.

## Reporte duplicatas

N√£o se acanhe e nem se desmotive se seus bugs estiverem sendo sinalizados como duplicatas. √â improv√°vel ser o primeiro a relatar um incidente, o que torna a ocorr√™ncia de duplicatas ainda mais comum, mas isso n√£o tira a sua import√¢ncia, j√° que quanto mais gente sendo afetada por aquele problema, mais a prioridade da _issue_ tende a subir. Al√©m disso, duplicatas apresentam abordagens diferentes de uma inconsist√™ncia.

Consequentemente, ao reportar uma duplicata, voc√™ est√° fornecendo mais informa√ß√£o que pode ajudar na resolu√ß√£o de um incidente. Pode ser que voc√™ esteja conseguindo reproduzir o bug de uma forma diferente, ou ent√£o que voc√™ saiba de alguma solu√ß√£o ou _workaround_ para o ocorrido, ou at√© que o seu crashlog contenha informa√ß√µes complementares aos outros radares.

No Github, h√° uma controv√©rsia quanto ao üëç. Acredito ser importante adicionar o `+1` nas _issues_ como forma de sinalizar uma duplicata, pois caracteriza que h√° mais gente sendo afetada por aquela inconsist√™ncia, por√©m h√° quem acredite que n√£o agrega em nada. Inclusive, [na sess√£o 213 da WWDC](https://developer.apple.com/videos/play/wwdc2016/213/), os engenheiros da Apple pedem que, ao criar um radar, n√£o simplesmente copie e cole um j√° existente pois isso n√£o agrega informa√ß√£o e n√£o sobe a prioridade.

Caso algum radar seu seja marcado como uma duplicata, ser√° informado o `id` da _issue_ original, que pode ser buscado no OpenRadar onde pode-se ler os coment√°rios para saber se h√° alguma forma de contornar o problema, qual o status atual (se estiver atualizado) e o que a comunidade est√° falando em geral sobre isso.

## Deal with it üï∂

> "N√£o apresente problemas, apresente solu√ß√µes" - eu mesmo

Leve este mantra para a sua vida: "reclame menos". Se voc√™ tem poder para mudar algo, n√£o reclame: mude! Se voc√™ n√£o tem poder para mudar, de que adianta reclamar? Na hora de resolver uma situa√ß√£o, seja no trabalho, seja em casa ou na rua, n√£o apresente um problema: apresente uma solu√ß√£o. Isso n√£o significa que voc√™ deve reportar menos bugs, justo pelo contr√°rio! Reportar um bug √© o primeiro passo para resolv√™-lo.

Se voc√™ reportar um bug, sempre que poss√≠vel, apresente um fix ou ao menos um _workaround_. Se for no Github, submeta um pull-request. Seja pr√≥-ativo e resolva seu pr√≥prio problema ao inv√©s de esperar que os outros o resolvam por voc√™.

De nada adianta chorar sem agir. Ilumine o problema. Seja parte da solu√ß√£o. Melhore as ferramentas que voc√™ usa no dia-a-dia. Diminua a sua dor. Otimize o seu tempo. Ajude a comunidade a crescer. Pode ter certeza que no caminho voc√™ cresce junto.
